#include "TXLib.h"

int uroven_tekushii = 1;
int uroven_staryi = 0;


int x_ball;
int y_ball;
int point_cuba;
int speed_ball = 35;
bool Exit = false;
bool StartGame = false;
bool Start_level = false;
int risovatCub1 = 0;
int risovatCub2 = 0;
int risovatCub3 = 0;
int x_1 = 212;
int x_2 = 312;
int x_3 = 412;
int x_4 = 512;
int x_5 = 612;
int x_6 = 712;
int x_7 = 812;
int x_8 = 912;
int x_9 = 1012;

int y_1 = 119;
int y_2 = 219;
int y_3 = 319;
int y_4 = 419;
int y_5 = 519;
//int y_6 = 619;

struct Button
{
    int x1;
    int x2;
    int y1;
    int y2;
    COLORREF color;
    const char* text;
};

struct Oblast
{
    int poloj;
    int lx;
    int rx;
    int vy;
    int ny;
    int min_poloj;
    int max_poloj;
};

void drawButton(Button btn1);
int KNOPKAClick (Button exitButton, int risovat);
int clickOnOblkast(Oblast obl1);
int coord(Oblast obl1);

int get_max_poloj(int poloj);
int min_max_poloj(int poloj);
int get_min_y(int nomer_stroki);
int get_min_x(int nomer_stolbca);

int main()
    {
    txCreateWindow (1280, 720);

    HDC main_menu = txLoadImage ("pictures\\main_menu.bmp");
    HDC proba = txLoadImage ("pictures\\proba.bmp");
    HDC vsecuby = txLoadImage ("pictures\\vsecuby.bmp");
    HDC kartaurovneya = txLoadImage ("kartaurovneya.bmp");
    HDC fonurovnya = txLoadImage ("fonurovnya.bmp");

    //Сделать массивом
    /*int KOLICH_KNOPOK = 5;
    Button btn[KOLICH_KNOPOK];
    btn[0] = {0, 100,   0,  90, TX_RED, "Кнопка 1"};
    btn[1] = {0, 100,  90, 180, TX_YELLOW, "Кнопка 2"};
    btn[2] = {0, 100, 180, 270, TX_BLUE, "Кнопка 3"};
    btn[3] = {0, 100, 270, 360, TX_YELLOW, "Кнопка 4"};
    btn[4] = {0, 100, 360, 450, TX_BLUE, "Кнопка 5"};*/

    int KOLVO_OBLASTEI = 40;
    Oblast obl[KOLVO_OBLASTEI];

    obl[0] =  {1};
    obl[1] =  {5};
    obl[2] =  {1};
    obl[3] =  {5};
    obl[4] =  {1};
    obl[5] =  {5};
    obl[6] =  {1};
    obl[7] =  {5};

    obl[8] =  {1};
    obl[9] =  {5};
    obl[10] = {1};
    obl[11] = {5};
    obl[12] = { 1};
    obl[13] = {get_min_x(6),  get_min_x(7), get_min_y(2), get_min_y(3), 5};
    obl[14] = {get_min_x(7),  get_min_x(8), get_min_y(2), get_min_y(3), 1};
    obl[15] = {get_min_x(8), get_min_x(9), get_min_y(2), get_min_y(3), 5};

    obl[16] = {get_min_x(1),  get_min_x(2), get_min_y(3), get_min_y(4), 1};
    obl[17] = {get_min_x(2),  get_min_x(3), get_min_y(3), get_min_y(4), 5};
    obl[18] = {get_min_x(3),  get_min_x(4), get_min_y(3), get_min_y(4), 1};
    obl[19] = {get_min_x(4),  get_min_x(5), get_min_y(3), get_min_y(4), 5};
    obl[20] = {get_min_x(5),  get_min_x(6), get_min_y(3), get_min_y(4), 1};
    obl[21] = {get_min_x(6),  get_min_x(7), get_min_y(3), get_min_y(4), 5};
    obl[22] = {get_min_x(7),  get_min_x(8), get_min_y(3), get_min_y(4), 1};
    obl[23] = {get_min_x(8), get_min_x(9), get_min_y(3), get_min_y(4), 5};

    obl[24] = {get_min_x(1),  get_min_x(2), get_min_y(4), get_min_y(5), 1};
    obl[25] = {get_min_x(2),  get_min_x(3), get_min_y(4), get_min_y(5), 5};
    obl[26] = {get_min_x(3),  get_min_x(4), get_min_y(4), get_min_y(5), 1};
    obl[27] = {get_min_x(4),  get_min_x(5), get_min_y(4), get_min_y(5), 5};
    obl[28] = {get_min_x(5),  get_min_x(6), get_min_y(4), get_min_y(5), 1};
    obl[29] = {get_min_x(6),  get_min_x(7), get_min_y(4), get_min_y(5), 5};
    obl[30] = {get_min_x(7),  get_min_x(8), get_min_y(4), get_min_y(5), 1};
    obl[31] = {get_min_x(8), get_min_x(9), get_min_y(4), get_min_y(5), 5};

    //Прикинь, теперь 6 и 7 цифры можно не писать
    //Но я хочу не писать и первые 4. Заметь, что они постоянно увеличиваются на 100
    //Попробуй для начала сделать функцию, у которой на вход номер ряда (5 в случае ниже),
    //а она автоматом выдаст минимальный и максимальный y. Можно 2 функции сделать
    obl[32] = {1,  get_min_x(2), get_min_y(5), get_min_y(6), 1};
    obl[33] = {2,  get_min_x(3), get_min_y(5), get_min_y(6), 5};
    obl[34] = {get_min_x(3),  get_min_x(4), get_min_y(5), get_min_y(6), 1};
    obl[35] = {4 , get_min_x(5), get_min_y(5), get_min_y(6), 5};
    obl[36] = {get_min_x(5),  get_min_x(6), 3, 6, 1};
    obl[37] = {get_min_x(6),  7, get_min_y(5), get_min_y(6), 5};
    obl[38] = {get_min_x(7),  get_min_x(8), get_min_y(5), get_min_y(6), 1};
    obl[39] = {get_min_x(8), get_min_x(9), get_min_y(5), get_min_y(6), 5};


    for (int nomer_oblasti = 0; nomer_oblasti < KOLVO_OBLASTEI; nomer_oblasti++)
    { 
        //13%8 = 5, потому что 13 = 8 * 1 + 5
       obl[nomer_oblasti].lx = get_min_x((nomer_oblasti % 8) + 1);
       obl[nomer_oblasti].rx = get_min_x((nomer_oblasti % 8) + 2);
       obl[nomer_oblasti].vy = get_min_y(nomer_oblasti / 8 + 1);
       obl[nomer_oblasti].ny = get_min_y(nomer_oblasti / 8 + 2);
       obl[nomer_oblasti].max_poloj = get_max_poloj(obl[nomer_oblasti].poloj);
       obl[nomer_oblasti].min_poloj = min_max_poloj(obl[nomer_oblasti].poloj);
    }



    while(Exit == false && StartGame == false)
    {
        txBegin();
        txClear();
        txBitBlt (txDC(), 0, 0, 1280, 720, main_menu, 0, 0);

        if(txMouseButtons () == 1 &&
            txMouseX () >= 525 &&
            txMouseX () <= 689 &&
            txMouseY () >= 480 &&
            txMouseY () <= 580)
        {
            Exit = true;
        }
        if(txMouseButtons () == 1 &&
            txMouseX () >= 517 &&
            txMouseX () <= 704 &&
            txMouseY () >= 275 &&
            txMouseY () <= 368)
        {
            StartGame = true;
        }

        txSleep(10);
        txEnd();
    }

    if (StartGame == true)
    {

        txBitBlt (txDC(), 0, 0, 1280, 720, kartaurovneya, 0, 0);

        while(uroven_staryi < uroven_tekushii)
        {
            if(txMouseButtons () &1 &&
                txMouseX () >= 76 &&
                txMouseX () <= 175 &&
                txMouseY () >= 115 &&
                txMouseY () <= 214)
            {
                uroven_staryi = uroven_tekushii;
            }
            txSleep(10);
        }

        uroven_tekushii = uroven_tekushii + 1;

        //Как пройти игру / выйти из игры? Exit ведь всегда == false
        while(Exit == false)
        {

            txBegin();
            txBitBlt (txDC(), 0, 0, 1280, 720, fonurovnya, 0, 0);

            /*for (int nomer_knopki = 0; nomer_knopki < KOLICH_KNOPOK; nomer_knopki++)
            {
                drawButton(btn[nomer_knopki]);
            }
*/
            for (int nomer_oblasti = 0; nomer_oblasti < KOLVO_OBLASTEI; nomer_oblasti++)
            {
                //Ищем координату для рисования нужного кадра
                int coord1 = coord(obl[nomer_oblasti]);

                //Проверяем, что кадр не слишком большой
                if (clickOnOblkast(obl[nomer_oblasti]) == 1)
                {
                    obl[nomer_oblasti].poloj = obl[nomer_oblasti].poloj + 1;
                    if (obl[nomer_oblasti].poloj > obl[nomer_oblasti].max_poloj)
                    {
                        obl[nomer_oblasti].poloj = obl[nomer_oblasti].min_poloj;
                    }
                    //Не мешало бы сюда паузу добавить. А то очень тяжело кликом отловить нужное положение
                }

                txBitBlt (txDC(), obl[nomer_oblasti].lx, obl[nomer_oblasti].vy, obl[nomer_oblasti].rx - obl[nomer_oblasti].lx, obl[nomer_oblasti].ny - obl[nomer_oblasti].vy, vsecuby, coord1, 10);
            }
/*


            if (risovatCub1 == 1)
            {
                txBitBlt (txDC(), 315, 0, 100, 100, vsecuby, 248, 10);
                txBitBlt (txDC(), 515, 0, 100, 100, vsecuby, 366, 10);
                txBitBlt (txDC(), 515, 200, 100, 100, vsecuby, 129, 10);
                txBitBlt (txDC(), 315, 200, 100, 100, vsecuby, 10, 10);
            }

            if (risovatCub2 == 1)
            {
                txBitBlt (txDC(), 415, 0, 100, 100, vsecuby, 483, 10);
                txBitBlt (txDC(), 415, 200, 100, 100, vsecuby, 483, 10);
            }

            if (risovatCub3 == 1)
            {
                txBitBlt (txDC(), 315, 100, 100, 100, vsecuby, 602, 10);
                txBitBlt (txDC(), 515, 100, 100, 100, vsecuby, 602, 10);
            }




            if(txMouseButtons () == 1 &&
                txMouseX () >= 525 &&
                txMouseX () <= 689 &&
                txMouseY () >= 480 &&
                txMouseY () <= 580)
            {
                txBitBlt (txDC(), 400, 400, 1280, 720, proba, 0, 0);
            }

            risovatCub1 = KNOPKAClick(btn[0], risovatCub1);
            risovatCub2 = KNOPKAClick(btn[1], risovatCub2);
            risovatCub3 = KNOPKAClick(btn[2], risovatCub3);*/


            txSleep(10);
            txEnd();
        }
    }

    //Еще пару картинок забываешь удалить
    txDeleteDC(main_menu);
    txDeleteDC(proba);
    txDeleteDC(vsecuby);
    return 0;
}


int get_min_y(int nomer_stroki)
{
    int min_y = 0;
    if (nomer_stroki ==1)
    {
        min_y = 111;
    }
    else if (nomer_stroki ==2)
    {
        min_y = 211;
    }
    else if (nomer_stroki ==3)
    {
        min_y = 311;
    }
    else if (nomer_stroki ==4)
    {
        min_y = 411;
    }
    else if (nomer_stroki ==5)
    {
        min_y = 511;
    }
    else if (nomer_stroki ==6)
    {
        min_y = 611;
    }


    return min_y;
}

int get_min_x(int nomer_stolbca)
{
    int min_x = 0;
    if (nomer_stolbca ==1)
    {
        min_x = 238;
    }
    else if (nomer_stolbca ==2)
    {
        min_x = 338;
    }
    else if (nomer_stolbca ==3)
    {
        min_x = 438;
    }
    else if (nomer_stolbca ==4)
    {
        min_x = 538;
    }
    else if (nomer_stolbca ==5)
    {
        min_x = 638;
    }
    else if (nomer_stolbca ==6)
    {
        min_x = 738;
    }
    else if (nomer_stolbca ==7)
    {
        min_x = 838;
    }
    else if (nomer_stolbca ==8)
    {
        min_x = 938;
    }
    else if (nomer_stolbca ==9)
    {
        min_x = 1038;
    }


    return min_x;
}

int get_max_poloj(int poloj)
{
    int max_poloj = 0;
    if (poloj >= 1 and poloj <= 4)
    {
        max_poloj = 4;
    }
    else if (poloj >= 5 and poloj <=6)
    {
        max_poloj = 6;
    }

    return max_poloj;
}

int min_max_poloj(int poloj)
{
    int min_poloj = 0;
    if (poloj >= 1 and poloj <= 4)
    {
        min_poloj = 1;
    }
    else if (poloj >= 5 and poloj <=6)
    {
        min_poloj = 5;
    }

    return min_poloj;
}

int coord(Oblast obl1)
{
    int coord1 = 0;
    if (obl1.poloj == 1)
    {
        coord1 = 10;
    }
    else if (obl1.poloj == 2)
    {
        coord1 = 129;
    }
    else if (obl1.poloj == 3)
    {
        coord1 = 248;
    }
    else if (obl1.poloj == 4)
    {
        coord1 = 366;
    }
    else if (obl1.poloj == 5)
    {
        coord1 = 483;
    }
    else if (obl1.poloj == 6)
    {
        coord1 = 602;
    }

    return coord1;
}

void move_ball_rigth()
{
for(x_ball=point_cuba; x_ball<=point_cuba; x_ball++)
{
  x_ball=x_ball+speed_ball;
}
}

void move_ball_left()
{
for(x_ball=point_cuba; x_ball<=point_cuba; x_ball++)
{
 x_ball=x_ball-speed_ball;
}
}

void move_ball_up()
{
for(y_ball=point_cuba; y_ball<=point_cuba; y_ball++)
{
 y_ball=y_ball+speed_ball;
}
}

void move_ball_down()
{
for(y_ball=point_cuba; y_ball<=point_cuba; y_ball++)
{
 y_ball=y_ball-speed_ball;
}
}

void drawButton(Button btn1)
{
    txSetFillColor(RGB(0, 0, 255));
    txRectangle   (btn1.x1, btn1.y1, btn1.x2, btn1.y2);
    txSetFillColor(RGB(0,0,0));
    txRectangle   (btn1.x1+5, btn1.y1+5, btn1.x2-5, btn1.y2-5);
    txDrawText    (btn1.x1, btn1.y1, btn1.x2, btn1.y2, btn1.text);
}

int KNOPKAClick (Button exitButton, int risovat)
{
    if (txMouseX() > exitButton.x1  &&
        txMouseX() < exitButton.x2 &&
        txMouseY() > exitButton.y1  &&
        txMouseY() < exitButton.y2 &&
        txMouseButtons() & 1)
    {
        return 1;
    }

    return risovat;
}

int clickOnOblkast(Oblast obl1)
{
    if (txMouseButtons () == 1 &&
        txMouseX () >= obl1.lx &&
        txMouseX () <= obl1.rx &&
        txMouseY () >= obl1.vy &&
        txMouseY () <= obl1.ny)
     {
        return 1;
     }
     return 0;
}

void oblast_cubov_1()
{
 /* if(txMouseButtons () == 1 &&
     txMouseX () >= obl1.lx &&
     txMouseX () <= obl1.rx &&
     txMouseY () >= obl1.vy &&
     txMouseY () <= obl1.ny)
     {

     }     */

   if(txMouseButtons () == 1 &&
//      txMouseX () >= obl1.lx &&
      txMouseX () <= x_2 &&
      txMouseY () >= y_2 &&
      txMouseY () <= y_3)
      {

      }

      if(txMouseButtons () == 1 &&
      txMouseX () >= x_1 &&
      txMouseX () <= x_2 &&
      txMouseY () >= y_3 &&
      txMouseY () <= y_4)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_1 &&
      txMouseX () <= x_2 &&
      txMouseY () >= y_4 &&
      txMouseY () <= y_5)
      {

      }



}

void oblast_cubov_2()
{
   if(txMouseButtons () == 1 &&
     txMouseX () >= x_2 &&
     txMouseX () <= x_3 &&
     txMouseY () >= y_1 &&
     txMouseY () <= y_2)
     {

     }

   if(txMouseButtons () == 1 &&
      txMouseX () >= x_2 &&
      txMouseX () <= x_3 &&
      txMouseY () >= y_2 &&
      txMouseY () <= y_3)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_2 &&
      txMouseX () <= x_3 &&
      txMouseY () >= y_3 &&
      txMouseY () <= y_4)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_2 &&
      txMouseX () <= x_3 &&
      txMouseY () >= y_4 &&
      txMouseY () <= y_5)
      {

      }
}

void oblast_cubov_3()
{
   if(txMouseButtons () == 1 &&
     txMouseX () >= x_3 &&
     txMouseX () <= x_4 &&
     txMouseY () >= y_1 &&
     txMouseY () <= y_2)
     {

     }

   if(txMouseButtons () == 1 &&
      txMouseX () >= x_3 &&
      txMouseX () <= x_4 &&
      txMouseY () >= y_2 &&
      txMouseY () <= y_3)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_3 &&
      txMouseX () <= x_4 &&
      txMouseY () >= y_3 &&
      txMouseY () <= y_4)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_3 &&
      txMouseX () <= x_4 &&
      txMouseY () >= y_4 &&
      txMouseY () <= y_5)
      {

      }
}

void oblast_cubov_4()
{
   if(txMouseButtons () == 1 &&
     txMouseX () >= x_4 &&
     txMouseX () <= x_5 &&
     txMouseY () >= y_1 &&
     txMouseY () <= y_2)
     {

     }

   if(txMouseButtons () == 1 &&
      txMouseX () >= x_4 &&
      txMouseX () <= x_5 &&
      txMouseY () >= y_2 &&
      txMouseY () <= y_3)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_4 &&
      txMouseX () <= x_5 &&
      txMouseY () >= y_3 &&
      txMouseY () <= y_4)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_4 &&
      txMouseX () <= x_5 &&
      txMouseY () >= y_4 &&
      txMouseY () <= y_5)
      {

      }
}

void oblast_cubov_5()
{
   if(txMouseButtons () == 1 &&
     txMouseX () >= x_5 &&
     txMouseX () <= x_6 &&
     txMouseY () >= y_1 &&
     txMouseY () <= y_2)
     {

     }

   if(txMouseButtons () == 1 &&
      txMouseX () >= x_5 &&
      txMouseX () <= x_6 &&
      txMouseY () >= y_2 &&
      txMouseY () <= y_3)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_5 &&
      txMouseX () <= x_6 &&
      txMouseY () >= y_3 &&
      txMouseY () <= y_4)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_5 &&
      txMouseX () <= x_6 &&
      txMouseY () >= y_4 &&
      txMouseY () <= y_5)
      {

      }
}

void oblast_cubov_6()
{
   if(txMouseButtons () == 1 &&
     txMouseX () >= x_6 &&
     txMouseX () <= x_7 &&
     txMouseY () >= y_1 &&
     txMouseY () <= y_2)
     {

     }

   if(txMouseButtons () == 1 &&
      txMouseX () >= x_6 &&
      txMouseX () <= x_7 &&
      txMouseY () >= y_2 &&
      txMouseY () <= y_3)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_6 &&
      txMouseX () <= x_7 &&
      txMouseY () >= y_3 &&
      txMouseY () <= y_4)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_6 &&
      txMouseX () <= x_7 &&
      txMouseY () >= y_4 &&
      txMouseY () <= y_5)
      {

      }
}

void oblast_cubov_7()
{
   if(txMouseButtons () == 1 &&
     txMouseX () >= x_7 &&
     txMouseX () <= x_8 &&
     txMouseY () >= y_1 &&
     txMouseY () <= y_2)
     {

     }

   if(txMouseButtons () == 1 &&
      txMouseX () >= x_7 &&
      txMouseX () <= x_8 &&
      txMouseY () >= y_2 &&
      txMouseY () <= y_3)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_7 &&
      txMouseX () <= x_8 &&
      txMouseY () >= y_3 &&
      txMouseY () <= y_4)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_7 &&
      txMouseX () <= x_8 &&
      txMouseY () >= y_4 &&
      txMouseY () <= y_5)
      {

      }
}

void oblast_cubov_8()
{
   if(txMouseButtons () == 1 &&
     txMouseX () >= x_8 &&
     txMouseX () <= x_9 &&
     txMouseY () >= y_1 &&
     txMouseY () <= y_2)
     {

     }

   if(txMouseButtons () == 1 &&
      txMouseX () >= x_8 &&
      txMouseX () <= x_9 &&
      txMouseY () >= y_2 &&
      txMouseY () <= y_3)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_8 &&
      txMouseX () <= x_9 &&
      txMouseY () >= y_3 &&
      txMouseY () <= y_4)
      {

      }

    if(txMouseButtons () == 1 &&
      txMouseX () >= x_8 &&
      txMouseX () <= x_9 &&
      txMouseY () >= y_4 &&
      txMouseY () <= y_5)
      {

      }
}


